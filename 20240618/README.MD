# JWT 토큰
> 웹 표준으로 두 객체의 JSON 객체를 사용해서 정보를 안정성 있게 전달 하기 위해 사용한다.

## JSON Web Token
> 사용할 정보를 (암호화 된 상태로) 자체적으로 가지고 있고, 노출되도 되는 정보이다.
> JWT로 발급한 토큰은 기본정보 (유저 닉네임 혹은 프로필 경로)
> 토큰이 유효한지, 변조가 되지 않았는지 검증을 하기 위해서 서명이 포함되어있다.

## 로그인
> 정상적인 회원 인증 권한에서 사용한다.

1. JWT는 유저가 로그인을 요청하면 서버에서 유저의 정보를 가지고 정상적인 루트로 로그인을 요청한 유저인지 확인(검증)하고 토큰을 발급해서 전달해준다.
ex : 영화표를 불법이 아닌 정상적인 루트로 구매 했는지 검증
2. 유저가 서버에 요청을 할 때 JWT 토큰을 포함해서 요청을 하면 서버가 요청을 받았을 때 토큰의 검증을 하고 정상적인 회원인지 확인한다.

### 목적
> 안정성 있게 정보를 전달해서 요청을 보낼 수 있도록 하는게 목적이다.

### 해시화
> 해싱 기법을 적용해서 메시지의 위변조를 방지하기 위해 사용한다.

### JWT의 구조

```js
let header = {
    // 사용하는 해싱 알고리즘
    alg : "SHA256",
    // 토큰의 타입 내용
    type : "JWT"
}

// payload 에는 노출되도 괜찮은, 무관한 정보들만 담아야함
let payload = {
    // 토큰의 이름
    sub : "123",
    // 유저의 이름 (유저 프로필)
    name : "hyeok",
    // 주의해서 적어야 할 키
    // 토큰이 발급된 후 얼마나 시간이 지났는지, 사용했는지
    lat : "1111111111"
}
// 이 3가지가 payload에 들어갈 수도 있음

exp : 해당 토큰의 만료시간

// 누군가에게 토큰을 줄 수도 있음
and : 토큰을 발급받을 대상

// 이거는 엄청 중요하지 않음
lss : 토큰 발급자

// 서명
let signature = 해시화(hash) sha256(base64url(header)) + base64url(payload); 
```

### 구조
1. header : 타입과 알고리즘의 정보의 내용
2. payload : 유저의 정보와 만료기간이 포함된 내용
3. signature : header + payload를 인코딩해서 더한 내용이 비밀키


```sh
# express 초기화, 대기 상태
# views page 폴더 지정
# view engine ejs
# 깊은 객체 안 씀
# 바디 객체를 JSON 형식으로 받겠다.
# env에 필요한 내용을 작성

npm i express ejs jsonwebtoken dotenv

```